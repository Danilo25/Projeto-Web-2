<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<span id="user-context" th:data-userid="${userId}" class="d-none"></span>

<div class="container-fluid p-0">
    <div class="row g-0">
        
        <nav class="sidebar d-flex flex-column">
            <h6 class="sidebar-heading">Menu</h6>
            <ul class="nav flex-column mt-3">
                <li class="nav-item">
                    <a class="nav-link" th:href="@{/web/home/{id}(id=${userId})}">
                        <i class="bi bi-house-door-fill"></i> Home
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" th:href="@{/web/profile/{id}(id=${userId})}">
                        <i class="bi bi-person-circle"></i> Perfil
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/">
                        <i class="bi bi-box-arrow-right"></i> Sair
                    </a>
                </li>
            </ul>
        </nav>

        <main class="main-content col">
            <div class="d-flex flex-column">
            
                <h1 id="user-name-title">Meu Perfil</h1>
                <p class="lead text-secondary">Gerencie suas informações pessoais e de endereço.</p>
                
                <div id="alert-placeholder"></div>

                <hr class="my-4">

                <div class="row justify-content-center g-4">
                    <div class="col-lg-10 col-xl-9">
                        
                        <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Informações Pessoais</h5>
                                <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#editUserModal">
                                    Editar
                                </button>
                            </div>
                            <div class="card-body">
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item"><strong>Nome:</strong> <span id="info-name">Carregando...</span></li>
                                    <li class="list-group-item"><strong>Email:</strong> <span id="info-email">Carregando...</span></li>
                                    <li class="list-group-item"><strong>Cargo:</strong> <span id="info-position">Carregando...</span></li>
                                </ul>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Endereço</h5>
                                <button class="btn btn-primary btn-sm" id="btn-edit-address" data-bs-toggle="modal" data-bs-target="#editAddressModal">
                                    Editar
                                </button>
                            </div>
                            <div class="card-body" id="address-card-body">
                                <p id="address-loading-text">Carregando endereço...</p>
                            </div>
                        </div>
                    
                    </div>
                </div>

            </div>
        </main>
    </div>
</div>


<div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editUserModalLabel">Editar Informações Pessoais</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="edit-user-form" novalidate>
                <div class="modal-body">
                    <div id="user-modal-alert"></div>
                    
                    <div class="mb-3">
                        <label for="edit-name" class="form-label">Nome *</label>
                        <input type="text" class="form-control" id="edit-name" required>
                    </div>
                    <div class="mb-3">
                        <label for="edit-email" class="form-label">Email *</label>
                        <input type="email" class="form-control" id="edit-email" required>
                    </div>
                    <div class="mb-3">
                        <label for="edit-position" class="form-label">Cargo</label>
                        <input type="text" class="form-control" id="edit-position">
                    </div>
                    <div class="mb-3">
                        <label for="edit-password" class="form-label">Nova Senha (Opcional)</label>
                        <input type="password" class="form-control" id="edit-password" placeholder="Deixe em branco para não alterar">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>
</div>


<div class="modal fade" id="editAddressModal" tabindex="-1" aria-labelledby="editAddressModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editAddressModalLabel">Editar Endereço</h5>
                <button type="button " class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="edit-address-form" novalidate>
                <div class="modal-body">
                    <div id="address-modal-alert"></div>

                    <div class="mb-3">
                        <label for="edit-publicPlace" class="form-label">Logradouro (Rua/Av.)</label>
                        <input type="text" class="form-control" id="edit-publicPlace">
                    </div>
                    <div class="mb-3">
                        <label for="edit-district" class="form-label">Bairro</label>
                        <input type="text" class="form-control" id="edit-district">
                    </div>
                    <div class="mb-3">
                        <label for="edit-city" class="form-label">Cidade</label>
                        <input type="text" class="form-control" id="edit-city">
                    </div>
                    <div class="mb-3">
                        <label for="edit-state" class="form-label">Estado (UF)</label>
                        <input type="text" class="form-control" id="edit-state" maxlength="2">
                    </div>
                    <div class="mb-3">
                        <label for="edit-zipCode" class="form-label">CEP</label>
                        <input type="text" class="form-control" id="edit-zipCode">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar Endereço</button>
                </div>
            </form>
        </div>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script type="module" src="/js/profile.js"></script>

</body>
</html>